<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Voltage pulse design with CSP: 2 dots &mdash; QuDiPy Simulator Oct. 11th 2023 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="QuDiPy tutorial: using the charge stability module" href="Charge%20Stability.html" />
    <link rel="prev" title="qudipy.utils package" href="../../qudipy.utils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            QuDiPy Simulator
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">QuDiPy (Quantum Dots in Python)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">QuDiPy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Voltage pulse design with CSP: 2 dots</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#1.-Addressing-individual-spins-in-the-global-ESR-field">1. Addressing individual spins in the global ESR field</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.1-Constructing-a-DotArray-object">1.1 Constructing a DotArray object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.2.-Constructing-DesignerCSP-objects">1.2. Constructing DesignerCSP objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.2.1-Using-DesignerCSP-class-constructor">1.2.1 Using DesignerCSP class constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#1.2.2-Using-shortcut-functions-(rot,-hadamard,-swapk,-cphase)">1.2.2 Using shortcut functions (<code class="docutils literal notranslate"><span class="pre">rot</span></code>, <code class="docutils literal notranslate"><span class="pre">hadamard</span></code>, <code class="docutils literal notranslate"><span class="pre">swapk</span></code>, <code class="docutils literal notranslate"><span class="pre">cphase</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#1.3-Creating-or-selecting-shape-functions">1.3 Creating or selecting shape functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.4-Composing-time-dependent-pulses-with-a-DesignerCSP-object">1.4 Composing time-dependent pulses with a DesignerCSP object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.5-Evolving-spin-states-under-the-designed-pulses">1.5 Evolving spin states under the designed pulses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#1.5.1-Defining-spin-states-using-State-class">1.5.1 Defining spin states using <code class="docutils literal notranslate"><span class="pre">State</span></code> class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#1.5.2-Evolving-spin-systems">1.5.2 Evolving spin systems</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#2.-\mathrm{SWAP}^k-two-qubit-gates">2. <span class="math notranslate nohighlight">\(\mathrm{SWAP}^k\)</span> two-qubit gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#3.-\mathrm{CPHASE}(\alpha)-two-qubit-gates">3. <span class="math notranslate nohighlight">\(\mathrm{CPHASE}(\alpha)\)</span> two-qubit gates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Charge%20Stability.html">QuDiPy tutorial: using the charge stability module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dot%20Array%20Class%20Usage%202%20Dots.html">How to contruct dot array system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dot%20Array%20Class%20Usage%203%20Dots.html">DotArray Object for a Triple Quantum Dot Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="Effective_spin_control.html">Effective spin control: pulse design &amp; state evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="Electron%20Shuttling.html">Electron Shuttling</a></li>
<li class="toctree-l1"><a class="reference internal" href="GIFs.html">Animations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">In Development:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/Unit%20Tests.html">Unit test tutorial: Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../res/Creating%20Interpolation%20Objects%20via%20HPC.html">Calculate Interpolation Objects in Batches with Job Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Dot%20Array%20Class%20Usage%202%20Dots%20-%20HPC%20Example.html">How to Construct Dot Array System from HPC Generated Interpolation Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Dot%20Array%20Class%20Usage%204%20Dots.html">DotArray Object for a Quadruple Quantum Dot Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/DotArray%20Class%20Constructors.html">DotArray: Alternative Class Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Fitting.html">Finding Best Quartic Fit - 2 dot system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Loading%20Potentials.html">Loading potentials tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Masking%20Dot%20Array%20Potentials.html">How Utilize Potential Lanscape Masking for Isolating Dots in Dot Array</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Operator%20Creation.html">Operator Creation Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Schrodinger%20Equation.html">Using the single electron Schrödinger equation solver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Schrodinger%20Equation%20on%20Uniform%20and%20Non-Uniform%20Mesh%20Grids.html">Solve 1D and 2D Schödinger Equation on Uniform and Non-Uniform Grids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Stark%20Shift.html">QuDiPy tutorial: Using the Stark shift module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../res/Understanding%20Effective%20Parameter%20Behavior.html">Understanding Effectvie Parameter Behavior</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Webpage Maintenance:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../web/Configure%20Static%20Webpage%20Using%20Sphinx.html">Notes on Configuring a Static Webpage Using Sphinx</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">QuDiPy Simulator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Voltage pulse design with CSP: 2 dots</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/tutorials/CSP_voltage_design_2_Dots.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Voltage-pulse-design-with-CSP:-2-dots">
<h1>Voltage pulse design with CSP: 2 dots<a class="headerlink" href="#Voltage-pulse-design-with-CSP:-2-dots" title="Permalink to this heading"></a></h1>
<p>This tutorial shows how to construct voltage pulses for basic quantum gates using <strong>Constrained Shape Pulse (CSP)</strong> algorithm (see <a class="reference external" href="https://uwspace.uwaterloo.ca/handle/10012/17823">Chapter 4 of Bohdan’s thesis</a> for theory).</p>
<div class="line-block">
<div class="line">The outline of each test case is as follows: 1. Constructing a <strong>DotArray</strong> object</div>
<div class="line">3. Creating <strong>DesignerCSP</strong> objects, which contains the in-built pulse design method</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Choosing effective parameter <strong>shape functions</strong></p></li>
<li><p>Composing <strong>pulse sequences</strong> out of designer objects for a choice of shapes and times</p></li>
<li><p>Performing <strong>spin density matrix evolution</strong> of a chosen <strong>state</strong> and plotting parameters:</p>
<ul class="simple">
<li><p>fidelity</p></li>
<li><p>1-qubit subspace evolution on the Bloch spheres</p></li>
</ul>
</li>
</ol>
<p>The steps above are discussed in detail for a selective qubit rotation. At the end of the tutorial, the entire effective pulse design and evolution routine is demonstrated for <span class="math notranslate nohighlight">\(\mathrm{SWAP}^k\)</span> and CPHASE gates, and the effects of spin relaxation and dephasing (to be added).</p>
<blockquote>
<div><p>Necessary imports and default plotting parameters:</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="c1"># update base working directory to QuDiPy</span>
<span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">stem</span> <span class="o">!=</span> <span class="s1">&#39;QuDiPy&#39;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">base_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">base_dir</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
c:\QuDiPy
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import os, sys</span>
<span class="c1"># sys.path.append(os.path.dirname(os.getcwd()))     # adding parent folder to path</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">from</span> <span class="nn">qudipy.system</span> <span class="kn">import</span> <span class="n">State</span><span class="p">,</span> <span class="n">DotArray</span>
<span class="kn">from</span> <span class="nn">qudipy.design</span> <span class="kn">import</span> <span class="n">voltage_csp</span><span class="p">,</span> <span class="n">shapes</span>
<span class="kn">from</span> <span class="nn">qudipy.design.voltage_csp</span> <span class="kn">import</span> <span class="n">DesignerCSP</span>
</pre></div>
</div>
</div>
<section id="1.-Addressing-individual-spins-in-the-global-ESR-field">
<h2>1. Addressing individual spins in the global ESR field<a class="headerlink" href="#1.-Addressing-individual-spins-in-the-global-ESR-field" title="Permalink to this heading"></a></h2>
<p>The goal of this section is to demonstrate selective rotation of the 1st qubit of a 2-qubit system:</p>
<div class="math notranslate nohighlight">
\[Y_1\left(\frac{\pi}{2}\right)
|\uparrow -\rangle = |+ -\rangle\]</div>
<section id="1.1-Constructing-a-DotArray-object">
<h3>1.1 Constructing a DotArray object<a class="headerlink" href="#1.1-Constructing-a-DotArray-object" title="Permalink to this heading"></a></h3>
<p>Define the directory to store 2D potential slice data extracted from nextnano simulations for a given device, as well as, to store calculated variables such as <span class="math notranslate nohighlight">\(g\)</span>-factor deviation, exchange, or Hubbard parameters for individual dots or dot pairs.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nav_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;QuDiPy data&#39;</span><span class="p">,</span> <span class="s1">&#39;tutorials&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">processed_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">nav_dir</span><span class="p">,</span>
                            <span class="s1">&#39;processed&#39;</span><span class="p">,</span><span class="s1">&#39;2QD_processed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Define the directory location that contains all of the nextnano simulation data files to be processed or imported.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nextnano_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">nav_dir</span><span class="p">,</span>
                                    <span class="s1">&#39;nextnano&#39;</span><span class="p">,</span><span class="s1">&#39;2QD_dotsep_60nm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Define the anticipated number of quantum dots. This variable will determine if dot merger events occur under various voltage configurations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_dots</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<p>If desired, define control parameters to use when interpolating the potential data from nextnano: must be a subset of the raw data or the full set of raw data. If not specified, the default is to interpolate over all raw data.</p>
<blockquote>
<div><p><strong>Note</strong>: These will greatly influence the accuracy of the resultant calculations as well as the run time of the <code class="docutils literal notranslate"><span class="pre">Dots()</span></code> class upon initial data processing.</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eff_interp_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="n">ctrl_vals</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="n">eff_interp_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">eff_interp_dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="n">eff_interp_dims</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<p>The effective parameter interpolation values could be specified by the keyword <code class="docutils literal notranslate"><span class="pre">eff_interp_dims</span></code> instead. This parameters indicates the number(s) of values for each control parameter to use in the interpolator construction. The data evenly spaced within min-max range of nextnano data). If a single integer is specified, then it determines the # of points / sweep for each control.</p>
<blockquote>
<div><p>Note: if <code class="docutils literal notranslate"><span class="pre">ctrl_vals</span></code> is specified, it has priority over <code class="docutils literal notranslate"><span class="pre">eff_interp_dims</span></code></p>
</div></blockquote>
<p>Keyword <code class="docutils literal notranslate"><span class="pre">'save'=True</span></code> allows to save the interpolating object into a pickle (binary) file in the <code class="docutils literal notranslate"><span class="pre">precalculated_dir</span></code>. If such a file exists already, it is automatically loaded, and the interpolators are not evaluated again. This significantly speeds up other calculations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file_prefix</span> <span class="o">=</span> <span class="s1">&#39;tutorial&#39;</span>
</pre></div>
</div>
</div>
<p>Now, we instantiate a <code class="docutils literal notranslate"><span class="pre">Dots()</span></code> class object instance using the previously defined variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the effective parameters and/or load the masked potential</span>
<span class="c1"># lanscapes as well as save 2D potential slices to Pre-processed directory</span>
<span class="n">dots</span> <span class="o">=</span> <span class="n">DotArray</span><span class="p">(</span><span class="n">n_dots</span><span class="p">,</span> <span class="n">ctrl_ranges</span><span class="o">=</span><span class="n">ctrl_vals</span><span class="p">)</span>
<span class="n">dots</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="n">processed_dir</span><span class="p">,</span> <span class="n">nextnano_dir</span><span class="p">,</span> <span class="n">file_prefix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading pre-calculated spin interpolators from
c:\QuDiPy\QuDiPy data\tutorials\processed\2QD_processed\tutorial_spin_data_size_[6 6 6]_from_[ 0.2 -0.1  0.2]_to_[0.45 0.15 0.45].pkl
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;qudipy.system.dot_array.DotArray at 0x266ebe0d290&gt;
</pre></div></div>
</div>
<p>Giving voltage parameters shorter names for convenient plotting</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dots</span><span class="o">.</span><span class="n">ctrl_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$V_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;$W_1$&#39;</span><span class="p">,</span><span class="s1">&#39;$V_2$&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="1.2.-Constructing-DesignerCSP-objects">
<h3>1.2. Constructing DesignerCSP objects<a class="headerlink" href="#1.2.-Constructing-DesignerCSP-objects" title="Permalink to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Designer</span></code> class and its child <code class="docutils literal notranslate"><span class="pre">DesignerCSP</span></code> handle control parameters that determine time-dependent pulse sequences. The following functions are defined in <code class="docutils literal notranslate"><span class="pre">qudipy.design.voltage_csp</span></code> module to conveniently construct DesignerCSP objects for: - arbitrary qubit rotations (<code class="docutils literal notranslate"><span class="pre">rot</span></code>), - Hadamard gates (<code class="docutils literal notranslate"><span class="pre">hadamard</span></code>), - <span class="math notranslate nohighlight">\(\mathrm{SWAP}^k\)</span> gates (<code class="docutils literal notranslate"><span class="pre">swapk</span></code>), and - <span class="math notranslate nohighlight">\(\mathrm{CPHASE}(\alpha)\)</span> gates (<code class="docutils literal notranslate"><span class="pre">cphase</span></code>),</p>
<p>All <code class="docutils literal notranslate"><span class="pre">DesignerCSP</span></code> objects require these parameters in advance to determine the idling state, the rotating frame, and perform a numerical integration: - <code class="docutils literal notranslate"><span class="pre">init_detuning_guess</span></code>: initial guess of voltage configuration <code class="docutils literal notranslate"><span class="pre">[v_1,</span> <span class="pre">w_1,</span> <span class="pre">v_2,</span> <span class="pre">w_2...]</span></code> to find the idling state, - <strong>either</strong> Zeeman field [T] <strong>or</strong> ESR central frequency [Hz], - <code class="docutils literal notranslate"><span class="pre">min_length</span></code>: shortest anticipated pulse length <span class="math notranslate nohighlight">\(T_\mathrm{min}.\)</span></p>
<p>The CSP integration routine finds functions of type</p>
<div class="math notranslate nohighlight">
\[\vec{V}\left(s\right), \vec{W}\left(s\right), \quad s=S\dfrac{T_\mathrm{min}}{T},\]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is pulse length, and <span class="math notranslate nohighlight">\(S(t)\)</span> is the normalized shape function (see sec. 1.4 for more information). <span class="math notranslate nohighlight">\(T_\mathrm{min}\)</span> is typically larger than the user-defined value if there are additional system constraints (#TODO will be adjusted accordingly). Optional parameter <span class="math notranslate nohighlight">\(S_\mathrm{max}\)</span> (10 by default) limits the class of shape functions that can be used to compose a pulse. For example, <span class="math notranslate nohighlight">\(S_\mathrm{max}=10\)</span> encompasses all Gaussian shapes with <span class="math notranslate nohighlight">\(\sigma&gt;0.05\)</span>,
which is more than enough for most applications.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_idle_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.287</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.275</span><span class="p">]</span>
<span class="n">B_zeeman</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># tesla</span>
</pre></div>
</div>
</div>
<section id="1.2.1-Using-DesignerCSP-class-constructor">
<h4>1.2.1 Using DesignerCSP class constructor<a class="headerlink" href="#1.2.1-Using-DesignerCSP-class-constructor" title="Permalink to this heading"></a></h4>
<p>Manually creating a DesignerCSP for a <span class="math notranslate nohighlight">\(Z(\pi/2)\)</span> rotation of the first qubit:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_des</span> <span class="o">=</span> <span class="n">DesignerCSP</span><span class="p">(</span><span class="n">dots</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">v_idle_guess</span><span class="p">,</span> <span class="mf">10e-6</span><span class="p">,</span> <span class="n">B_zeeman</span><span class="o">=</span><span class="n">B_zeeman</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initial detuning is found to be  [2.81032433e-01 6.43139240e-05 2.81032584e-01]
Start solving system of ODEs
Solution FOUND!
</pre></div></div>
</div>
<p>Plotting dependencies <span class="math notranslate nohighlight">\(V(s), W(s)\)</span>, where <span class="math notranslate nohighlight">\(s=S\frac{T_\mathrm{min}}{T}\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s_steps</span><span class="p">,</span> <span class="n">test_des</span><span class="o">.</span><span class="n">voltages_of_s</span><span class="p">(</span><span class="n">s_steps</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;$V_1(s)$&#39;</span><span class="p">,</span><span class="s1">&#39;$W_1(s)$&#39;</span><span class="p">,</span> <span class="s1">&#39;$V_2(s)$&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_26_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_26_0.png" />
</div>
</div>
</section>
<section id="1.2.2-Using-shortcut-functions-(rot,-hadamard,-swapk,-cphase)">
<h4>1.2.2 Using shortcut functions (<code class="docutils literal notranslate"><span class="pre">rot</span></code>, <code class="docutils literal notranslate"><span class="pre">hadamard</span></code>, <code class="docutils literal notranslate"><span class="pre">swapk</span></code>, <code class="docutils literal notranslate"><span class="pre">cphase</span></code>)<a class="headerlink" href="#1.2.2-Using-shortcut-functions-(rot,-hadamard,-swapk,-cphase)" title="Permalink to this heading"></a></h4>
<p>Building up a designer for synchronous rotations of the 1st qubit in a 2-qubit system by an angle <span class="math notranslate nohighlight">\(-3 \pi/8\)</span>. The cumulative effect of such 4 pulses will give a <span class="math notranslate nohighlight">\(-3 \pi/2\)</span> rotation equivalent to <span class="math notranslate nohighlight">\(\pi/2\)</span>. Any other combination of angles that gives total angle <span class="math notranslate nohighlight">\(\pi/2 \mod 2\pi\)</span> can be used.</p>
<p>The optional parameters in the shortcut functions include: - <code class="docutils literal notranslate"><span class="pre">exchange_method</span></code>: Heitler-London (<code class="docutils literal notranslate"><span class="pre">HL</span></code>) or Hund-Mulliken (<code class="docutils literal notranslate"><span class="pre">HM</span></code>, default) - <code class="docutils literal notranslate"><span class="pre">rel_diff_step</span></code>: differentiation step size relative to the min-max value of control parameter range. Default is <span class="math notranslate nohighlight">\(10^{-6}\)</span> - <code class="docutils literal notranslate"><span class="pre">masking</span></code>: masking method to use for effective parameter evaluation</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_idle_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.278</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.275</span><span class="p">]</span>

<span class="n">rot_des</span> <span class="o">=</span> <span class="n">voltage_csp</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="n">dot_array</span><span class="o">=</span><span class="n">dots</span><span class="p">,</span> <span class="n">active_qubits</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span>
                          <span class="n">min_length</span><span class="o">=</span><span class="mf">6e-6</span><span class="p">,</span>  <span class="n">init_detuning_guess</span><span class="o">=</span><span class="n">v_idle_guess</span> <span class="p">,</span> <span class="n">B_zeeman</span> <span class="o">=</span><span class="n">B_zeeman</span><span class="p">,</span>
                                 <span class="n">rel_diff_step</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span> <span class="n">masking</span><span class="o">=</span><span class="s1">&#39;harsh&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initial detuning is found to be  [ 0.27646684 -0.0102404   0.27646696]
Start solving system of ODEs
Solution FOUND!
</pre></div></div>
</div>
<p>Alternatively, one can define a Hadamard designer instead that will give the same evolution for the chosen initial state &amp; compose a pulse with it.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rot_des = effective.hadamard(dot_array=dots, active_qubits= 1,</span>
<span class="c1">#                           min_length=5e-6,</span>
<span class="c1">#                                  init_detuning_guess=v_idle_guess , B_zeeman =B_zeeman,</span>
<span class="c1">#                                  rel_diff_step=1e-7)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="1.3-Creating-or-selecting-shape-functions">
<h3>1.3 Creating or selecting shape functions<a class="headerlink" href="#1.3-Creating-or-selecting-shape-functions" title="Permalink to this heading"></a></h3>
<p>The shape function that defines the effective pulses can be any function of normalized time with unit expectation value:</p>
<div class="math notranslate nohighlight">
\[S(\tau): [0,1]\rightarrow \mathbb{R}: \qquad  \langle S \rangle = \int_0^1 S(\tau) \mathrm{d}\tau = 1.\]</div>
<p>The library of pre-defined shapes includes square, triangular and Gaussian functions. They can be either: - accessed through <code class="docutils literal notranslate"><span class="pre">qudipy.design.shapes</span></code> module, <em>or</em> - specified as ‘string keywords’ when creating a <code class="docutils literal notranslate"><span class="pre">ControlPulse</span></code> objects (see next)</p>
<p>Defining 4 different shape functions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unit_square</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">square</span><span class="p">()</span>
<span class="n">unit_triangle</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">triangle</span><span class="p">()</span>
<span class="n">unit_wide_gauss</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
<span class="n">unit_narrow_gauss</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">list_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_square</span><span class="p">,</span> <span class="n">unit_triangle</span><span class="p">,</span> <span class="n">unit_narrow_gauss</span><span class="p">,</span> <span class="n">unit_wide_gauss</span><span class="p">]</span>
<span class="n">list_shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">unit_wide_gauss</span><span class="p">,</span> <span class="n">unit_triangle</span><span class="p">,</span> <span class="n">unit_narrow_gauss</span><span class="p">,</span> <span class="n">unit_wide_gauss</span><span class="p">]</span>
<br/></pre></div>
</div>
</div>
<p>Plotting these shapes:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalized time points</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.18</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">shape</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_shapes</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span>].plot(tau , shape(tau), label=shape.__name__)
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span>].legend()

    <span class="c1"># Setting axes labels.</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span>].set_xlabel(&#39;$\\tau$&#39;, size=12)

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;$S(</span><span class="se">\\</span><span class="s1">tau)$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_34_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_34_0.png" />
</div>
</div>
</section>
<section id="1.4-Composing-time-dependent-pulses-with-a-DesignerCSP-object">
<h3>1.4 Composing time-dependent pulses with a DesignerCSP object<a class="headerlink" href="#1.4-Composing-time-dependent-pulses-with-a-DesignerCSP-object" title="Permalink to this heading"></a></h3>
<p>Each <code class="docutils literal notranslate"><span class="pre">DesignerCSP</span></code> object is capable of composing time-dependent pulses with different: - shapes - lengths - constraints (min/max values of parameters, bandwitdth, etc.)</p>
<p>Below, we compose four <code class="docutils literal notranslate"><span class="pre">ControlPulse</span></code> objects with <strong>different shapes</strong> and same length <span class="math notranslate nohighlight">\(T=1\mu s\)</span> that correspond to the same <span class="math notranslate nohighlight">\(Y_1(-\frac{3\pi}{8})\)</span> operation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_pulses</span> <span class="o">=</span> <span class="p">[</span><span class="n">rot_des</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">num_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">7e-6</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">sh</span><span class="p">)</span>
                                                        <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">list_shapes</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">For all effective pulses we design here, the physical quantities that could vary over time include:</div>
<div class="line">- RF magnetic field magnitude <code class="docutils literal notranslate"><span class="pre">&quot;B_rf&quot;</span></code> and phase <code class="docutils literal notranslate"><span class="pre">&quot;phi&quot;</span></code> (in rotation frame) - Deviation g-factor of the <span class="math notranslate nohighlight">\(i^{th}\)</span> electron <code class="docutils literal notranslate"><span class="pre">&quot;delta_g_{i}&quot;</span></code> - Exchange couplings between the <span class="math notranslate nohighlight">\(i^{th}\)</span> and <span class="math notranslate nohighlight">\((j)^{th}\)</span> electrons <code class="docutils literal notranslate"><span class="pre">&quot;J_{ij}&quot;</span></code></div>
</div>
<p>Plotting voltage &amp; effective parameters of the triangular (2nd) pulse (all variables are in SI units):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_pulses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="n">dots</span><span class="o">.</span><span class="n">ctrl_names</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">train_pulses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;delta_g_1&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_g_2&#39;</span><span class="p">],</span><span class="n">figsize</span><span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">))</span>
<span class="n">train_pulses</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B_rf&#39;</span><span class="p">],</span> <span class="n">figsize</span><span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_38_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_38_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_38_1.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_38_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_38_2.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_38_2.png" />
</div>
</div>
</section>
<section id="1.5-Evolving-spin-states-under-the-designed-pulses">
<h3>1.5 Evolving spin states under the designed pulses<a class="headerlink" href="#1.5-Evolving-spin-states-under-the-designed-pulses" title="Permalink to this heading"></a></h3>
<section id="1.5.1-Defining-spin-states-using-State-class">
<h4>1.5.1 Defining spin states using <code class="docutils literal notranslate"><span class="pre">State</span></code> class<a class="headerlink" href="#1.5.1-Defining-spin-states-using-State-class" title="Permalink to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">State</span></code> class from <code class="docutils literal notranslate"><span class="pre">qudipy.system.state</span></code> handles many-electron states in different spaces: - spin - orbital - valley - Hubbard (spin + charge)</p>
<p>Currently, only spin states are handled. Defining some basic 1-qubit spin wavefunctions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_up</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>                           <span class="c1"># pure spin up state</span>
<span class="n">psi_down</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>                         <span class="c1"># pure spin down state</span>
<span class="n">psi_plus</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>           <span class="c1"># pure |+&gt; state</span>
<span class="n">psi_minus</span> <span class="o">=</span>  <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>        <span class="c1"># pure |-&gt; state</span>
</pre></div>
</div>
</div>
<p>The system of spins is described by the complex density matrix <span class="math notranslate nohighlight">\(\rho\)</span> whose evolution is of interest.</p>
<p>Several ways to define the spin state of <code class="docutils literal notranslate"><span class="pre">State</span></code> object are supported through <code class="docutils literal notranslate"><span class="pre">spin</span></code> keyword: - the density matrix of the whole system: square 2D array; - the wavefunction (<strong>ket</strong>-vector) of a pure state: row or column vector as 1D/2D array; - a list/tuple of density matrices, wavefunctions, or both, that describe subsystems constituting the whole system.</p>
<p>The density matrix of the whole system is generated and stored automatically irrespective of the type of input.</p>
<p>The number of electrons in the system <span class="math notranslate nohighlight">\(N\)</span> is inferred from the size of <span class="math notranslate nohighlight">\(\rho\)</span>; if it changes over time (e.g. due to measurements), the parameter <span class="math notranslate nohighlight">\(N_0\)</span> should be specified to indicate the maximal possible electron number. Otherwise, the equality <span class="math notranslate nohighlight">\(N=N_0\)</span> is assumed.</p>
<p>The environment parameters that can be specified as State object attributes include: - temperature (<code class="docutils literal notranslate"><span class="pre">T</span></code> keyword, <span class="math notranslate nohighlight">\(0\)</span> K by default) - <span class="math notranslate nohighlight">\(T_1\)</span>, <span class="math notranslate nohighlight">\(T_2\)</span> times (<code class="docutils literal notranslate"><span class="pre">T_1,</span> <span class="pre">T_2</span></code> keywords, <span class="math notranslate nohighlight">\(\infty\)</span> by default).</p>
<p>For now, we assume no dissipation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># defining states: initial and expected</span>
<span class="n">init_rot</span> <span class="o">=</span> <span class="n">State</span><span class="p">([</span><span class="n">psi_up</span><span class="p">,</span> <span class="n">psi_minus</span><span class="p">])</span>
<span class="n">exp_rot</span> <span class="o">=</span> <span class="n">State</span><span class="p">([</span><span class="n">psi_plus</span><span class="p">,</span>  <span class="n">psi_minus</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="1.5.2-Evolving-spin-systems">
<h4>1.5.2 Evolving spin systems<a class="headerlink" href="#1.5.2-Evolving-spin-systems" title="Permalink to this heading"></a></h4>
<div class="line-block">
<div class="line">The method <code class="docutils literal notranslate"><span class="pre">evolve</span></code> of a <code class="docutils literal notranslate"><span class="pre">State</span></code> object simulates the system evolution under a given pulse or iterable (tuple or list) of pulses. The iterable could be irregular, like, for example, <code class="docutils literal notranslate"><span class="pre">[pulse1,</span> <span class="pre">pulse2,</span> <span class="pre">[pulse3,</span> <span class="pre">(pulse4,</span> <span class="pre">pulse5)],</span> <span class="pre">pulse6]</span></code>. It returns a dictionary of 1D arrays of the user-specified parameters that are monitored throughout the simulation: - Purity of the density matrix - Evaluated when <code class="docutils literal notranslate"><span class="pre">eval_purity=True</span></code> is specified - <code class="docutils literal notranslate"><span class="pre">&quot;purity&quot;</span></code> entry in the resultant dictionary</div>
<div class="line">- Fidelity of the density matrix with respect to the theoretical (initial,expected final, etc.) matrix - Evaluated when <code class="docutils literal notranslate"><span class="pre">eval_fidelity=True</span></code> and the reference matrix <code class="docutils literal notranslate"><span class="pre">rho_reference</span></code> are specified - <code class="docutils literal notranslate"><span class="pre">&quot;fidelity&quot;</span></code> entry in the resultant dictionary</div>
<div class="line">- 1-electron density submatrices - Evaluated when a qubit / iterable of qubits to track <code class="docutils literal notranslate"><span class="pre">track_qubits</span></code> is specified - <code class="docutils literal notranslate"><span class="pre">&quot;submatrix_{i}&quot;</span></code> entry in the resultant dictionary</div>
<div class="line">- Bloch vector components <span class="math notranslate nohighlight">\(\langle \sigma_{x} \rangle, \langle \sigma_{y} \rangle, \langle \sigma_{z} \rangle\)</span> - Evaluated when <code class="docutils literal notranslate"><span class="pre">eval_Bloch_vectors=True</span></code> and an iterable of qubits to track <code class="docutils literal notranslate"><span class="pre">track_qubits</span></code> are specified - <code class="docutils literal notranslate"><span class="pre">&quot;sigma_x_{i}&quot;</span></code>,<code class="docutils literal notranslate"><span class="pre">&quot;sigma_y_{i}&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sigma_z_{i}&quot;</span></code> entries in the resultant dictionary</div>
</div>
<p>The other entry in the final dictionary, <code class="docutils literal notranslate"><span class="pre">&quot;time&quot;</span></code>, incorporates all points in time during the simulation.</p>
<p>An optional parameter <code class="docutils literal notranslate"><span class="pre">track_points_per_pulse</span></code> could be used to record only a part of the parameter values during the pulse to save memory (default is 100). In particular, it could be equated to 2 if one wants to record only the parameters before and after each pulse.</p>
<p>You can monitor the system evolution with the progress bars. If the system evolves under a sequence of pulses, the bars appear for each of them individually.</p>
<p>Here, we evolve system under four <span class="math notranslate nohighlight">\(\pi/8\)</span> pulses with different shapes designed above to obtain a <span class="math notranslate nohighlight">\(\pi/2\)</span> rotation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># defining states: initial and expected</span>
<span class="n">init_rot</span> <span class="o">=</span> <span class="n">State</span><span class="p">([</span><span class="n">psi_up</span><span class="p">,</span> <span class="n">psi_minus</span><span class="p">])</span>
<span class="n">exp_rot</span> <span class="o">=</span> <span class="n">State</span><span class="p">([</span><span class="n">psi_plus</span><span class="p">,</span>  <span class="n">psi_minus</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rot_data</span> <span class="o">=</span> <span class="n">init_rot</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">train_pulses</span><span class="p">,</span> <span class="n">rho_reference</span><span class="o">=</span> <span class="n">exp_rot</span><span class="o">.</span><span class="n">rho_spin</span><span class="p">,</span>
                           <span class="n">track_qubits</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">eval_fidelity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">eval_Bloch_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
ROTY-67.50° 1, step 1000: 100%|██████████| 1000/1000 [00:02&lt;00:00, 402.69it/s]
ROTY-67.50° 1, step 1000: 100%|██████████| 1000/1000 [00:02&lt;00:00, 424.36it/s]
ROTY-67.50° 1, step 1000: 100%|██████████| 1000/1000 [00:02&lt;00:00, 409.70it/s]
ROTY-67.50° 1, step 1000: 100%|██████████| 1000/1000 [00:02&lt;00:00, 367.95it/s]
</pre></div></div>
</div>
<p>Plotting evolution results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;sigma_x_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{x1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;sigma_y_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{y1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;sigma_z_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{z1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;1st qubit Bloch vector&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="c1">###############################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;sigma_x_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{x2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;sigma_y_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{y2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;sigma_z_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{z2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, $\mu$s&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;2nd qubit Bloch vector&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="c1">############</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">rot_data</span><span class="p">[</span><span class="s1">&#39;fidelity&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, $\mu$s&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">left[</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{Y}</span><span class="s1">_</span><span class="si">{1}</span><span class="se">\\</span><span class="s1">left(-</span><span class="se">\\</span><span class="s1">frac{3</span><span class="se">\\</span><span class="s1">pi}</span><span class="si">{8}</span><span class="se">\\</span><span class="s1">right)</span><span class="se">\\</span><span class="s1">right]^4$&#39;</span>
             <span class="s1">&#39;$ |</span><span class="se">\\</span><span class="s1">uparrow -</span><span class="se">\\</span><span class="s1">rangle = |+ -</span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_47_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_47_0.png" />
</div>
</div>
<p>Note the <span class="math notranslate nohighlight">\(2\pi\)</span> rotations around skewed axes that non-resonant qubit #3 goes through to preserve its initial states after each pulse.</p>
<p>Infidelity at the end:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">-</span> <span class="n">rot_data</span><span class="p">[</span><span class="s1">&#39;fidelity&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-1.5727517510555344e-08
</pre></div></div>
</div>
</section>
</section>
</section>
<section id="2.-\mathrm{SWAP}^k-two-qubit-gates">
<h2>2. <span class="math notranslate nohighlight">\(\mathrm{SWAP}^k\)</span> two-qubit gates<a class="headerlink" href="#2.-\mathrm{SWAP}^k-two-qubit-gates" title="Permalink to this heading"></a></h2>
<p>This and the following sections show how to quickly run everything altogether: state definition, pulse design, and state evolution.</p>
<p>Testing the operation <span class="math notranslate nohighlight">\(\mathrm{SWAP}_{12} |+ \uparrow -\rangle = |\uparrow + -\rangle\)</span> with four <span class="math notranslate nohighlight">\(\mathrm{SWAP}^{1/4}\)</span> pulses of different lengths.</p>
<blockquote>
<div><p>DesignerCSP objects for <span class="math notranslate nohighlight">\(\mathrm{SWAP}^{1/4}\)</span> pulses</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_idle_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.267</span><span class="p">]</span>

<span class="n">swap_des</span> <span class="o">=</span> <span class="n">voltage_csp</span><span class="o">.</span><span class="n">swapk</span><span class="p">(</span><span class="n">dot_array</span><span class="o">=</span><span class="n">dots</span><span class="p">,</span> <span class="n">qubit_pairs</span><span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                 <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span>
                                 <span class="n">init_detuning_guess</span><span class="o">=</span><span class="n">v_idle_guess</span><span class="p">,</span>
                                 <span class="n">B_zeeman</span> <span class="o">=</span>  <span class="n">B_zeeman</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initial detuning is found to be  [0.26353872 0.01021341 0.26353921]
Start solving system of ODEs
Solution FOUND!
</pre></div></div>
</div>
<blockquote>
<div><p>Composing pulses with <strong>different lengths</strong> <span class="math notranslate nohighlight">\(T = 1, 2, 5, 10\)</span> ns and same shape (gaussian with <span class="math notranslate nohighlight">\(\sigma=0.2\)</span>)</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_swap_pulses</span> <span class="o">=</span> <span class="p">[</span><span class="n">swap_des</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p>Plotting one of the voltage pulses</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_swap_pulses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="n">swap_des</span><span class="o">.</span><span class="n">dot_array</span><span class="o">.</span><span class="n">ctrl_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_57_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_57_0.png" />
</div>
</div>
<blockquote>
<div><p>Defining initial and expected spin states:</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_swap</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="p">[</span><span class="n">psi_plus</span><span class="p">,</span> <span class="n">psi_up</span><span class="p">,</span> <span class="n">psi_minus</span><span class="p">])</span>
<span class="n">exp_swap</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="p">[</span><span class="n">psi_up</span><span class="p">,</span> <span class="n">psi_plus</span><span class="p">,</span> <span class="n">psi_minus</span><span class="p">])</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p>Evolving qubit state, plotting fidelity and Bloch vectors</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">swap_data</span> <span class="o">=</span> <span class="n">init_swap</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">train_swap_pulses</span><span class="p">,</span> <span class="n">rho_reference</span><span class="o">=</span><span class="n">exp_swap</span><span class="o">.</span><span class="n">rho_spin</span><span class="p">,</span>
                            <span class="n">eval_fidelity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_qubits</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
                                    <span class="n">eval_Bloch_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
SWAP^0.25 (1, 2), step 1000: 100%|██████████| 1000/1000 [00:04&lt;00:00, 214.28it/s]
SWAP^0.25 (1, 2), step 1000: 100%|██████████| 1000/1000 [00:04&lt;00:00, 237.25it/s]
SWAP^0.25 (1, 2), step 1000: 100%|██████████| 1000/1000 [00:04&lt;00:00, 234.54it/s]
SWAP^0.25 (1, 2), step 1000: 100%|██████████| 1000/1000 [00:04&lt;00:00, 235.15it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="p">)</span>


<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;sigma_x_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{x1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;sigma_y_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{y1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;sigma_z_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{z1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;1st qubit Bloch vector&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="c1">###############################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;sigma_x_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{x2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;sigma_y_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{y2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;sigma_z_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{z2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, ns&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;2nd qubit Bloch vector&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="c1">############</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">swap_data</span><span class="p">[</span><span class="s1">&#39;fidelity&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, ns&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">left(</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{SWAP}</span><span class="s1">^{</span><span class="se">\\</span><span class="s1">, </span><span class="se">\\</span><span class="s1">frac</span><span class="si">{1}{4}</span><span class="s1">}_</span><span class="si">{12}</span><span class="se">\\</span><span class="s1">right)^4 </span><span class="se">\</span>
<span class="s1">             |+ </span><span class="se">\\</span><span class="s1">uparrow -</span><span class="se">\\</span><span class="s1">rangle = |</span><span class="se">\\</span><span class="s1">uparrow + -</span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_62_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_62_0.png" />
</div>
</div>
<p>Infidelity at the end:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">-</span> <span class="n">swap_data</span><span class="p">[</span><span class="s1">&#39;fidelity&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
7.993605777301127e-15
</pre></div></div>
</div>
</section>
<section id="3.-\mathrm{CPHASE}(\alpha)-two-qubit-gates">
<h2>3. <span class="math notranslate nohighlight">\(\mathrm{CPHASE}(\alpha)\)</span> two-qubit gates<a class="headerlink" href="#3.-\mathrm{CPHASE}(\alpha)-two-qubit-gates" title="Permalink to this heading"></a></h2>
<p>Running a control-Z operation:</p>
<div class="math notranslate nohighlight">
\[\mathrm{CZ}_{12} | + \downarrow \rangle = | - \downarrow\rangle\]</div>
<p>We represent each gate control-Z gate as a combination of two control-phase gates:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}    \mathrm{CZ} = \mathrm{CPHASE}(\pi) = \mathrm{CPHASE}(\pi/3) \mathrm{CPHASE}(2\pi/3)\\Initial and expected states:\end{aligned}\end{align} \]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_cz</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="p">[</span> <span class="n">psi_plus</span><span class="p">,</span> <span class="n">psi_down</span><span class="p">])</span>
<span class="n">exp_cz</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="p">[</span> <span class="n">psi_minus</span><span class="p">,</span> <span class="n">psi_down</span><span class="p">])</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p>Two DesignerCSP objects for <span class="math notranslate nohighlight">\(\mathrm{CPHASE}\)</span> pulses. Specifying all parameters, including shapes and times, right away this time</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cphase_pi3_des</span> <span class="o">=</span> <span class="n">voltage_csp</span><span class="o">.</span><span class="n">cphase</span><span class="p">(</span><span class="n">dots</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">init_detuning_guess</span> <span class="o">=</span><span class="n">v_idle_guess</span><span class="p">,</span>
                                 <span class="n">B_zeeman</span> <span class="o">=</span>  <span class="n">B_zeeman</span><span class="p">,</span>
                                 <span class="n">rel_diff_step</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
                                  <span class="n">min_length</span> <span class="o">=</span> <span class="mf">9e-6</span><span class="p">)</span>

<span class="n">cphase_2pi3_des</span> <span class="o">=</span> <span class="n">voltage_csp</span><span class="o">.</span><span class="n">cphase</span><span class="p">(</span><span class="n">dots</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">angle</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">init_detuning_guess</span> <span class="o">=</span> <span class="n">v_idle_guess</span><span class="p">,</span>
                                  <span class="n">B_zeeman</span> <span class="o">=</span> <span class="n">B_zeeman</span><span class="p">,</span>
                                 <span class="n">rel_diff_step</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">,</span>
                                        <span class="n">min_length</span> <span class="o">=</span> <span class="mf">9e-6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initial detuning is found to be  [0.26353872 0.01021341 0.26353921]
Start solving system of ODEs
Solution FOUND!
Initial detuning is found to be  [0.26353872 0.01021341 0.26353921]
Start solving system of ODEs
Solution FOUND!
</pre></div></div>
</div>
<blockquote>
<div><p>Composing corresponding pulses</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cphase_pulses</span> <span class="o">=</span> <span class="p">[</span><span class="n">cphase_pi3_des</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span>
                                                <span class="n">length</span> <span class="o">=</span> <span class="mf">1.2e-5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.25</span> <span class="p">),</span>
                        <span class="n">cphase_2pi3_des</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">num_steps</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                                    <span class="n">length</span> <span class="o">=</span>  <span class="mf">1.2e-5</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;triangle&#39;</span> <span class="p">)]</span>
<br/></pre></div>
</div>
</div>
<blockquote>
<div><p>Plotting the first pulse</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cphase_pulses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;delta_g_1&#39;</span><span class="p">,</span> <span class="s1">&#39;delta_g_2&#39;</span><span class="p">],</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cphase_pulses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;J_1&#39;</span><span class="p">])</span>
<span class="n">cphase_pulses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_ctrls</span><span class="o">=</span><span class="n">dots</span><span class="o">.</span><span class="n">ctrl_names</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_73_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_73_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_73_1.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_73_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_73_2.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_73_2.png" />
</div>
</div>
<blockquote>
<div><p>Evolving qubit state, plotting fidelity and Bloch vectors</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cphase_data</span> <span class="o">=</span> <span class="n">init_cz</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">cphase_pulses</span><span class="p">,</span> <span class="n">rho_reference</span><span class="o">=</span><span class="n">exp_cz</span><span class="o">.</span><span class="n">rho_spin</span><span class="p">,</span>
                            <span class="n">eval_fidelity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">track_qubits</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
                                    <span class="n">eval_Bloch_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
CPHASE(60.00°) (1, 2), step 1000: 100%|██████████| 1000/1000 [00:02&lt;00:00, 439.07it/s]
CPHASE(120.00°) (1, 2), step 1000: 100%|██████████| 1000/1000 [00:02&lt;00:00, 401.52it/s]
</pre></div></div>
</div>
<p>Plotting Bloch vector evolution of the qubits 1,2,3</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span> <span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;sigma_x_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{x1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;sigma_y_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{y1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;sigma_z_1&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{z1}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;1st qubit Bloch vector&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="c1">###############################</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;sigma_x_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{x2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;sigma_y_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{y2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;sigma_z_2&quot;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;⟨$\sigma_</span><span class="si">{z2}</span><span class="s2">$⟩&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, us&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;2nd qubit Bloch vector&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>



<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
         <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">cphase_data</span><span class="p">[</span><span class="s1">&#39;fidelity&#39;</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time, us&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fidelity&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{CPHASE}</span><span class="s1">_{12, 34}</span><span class="se">\\</span><span class="s1">left(</span><span class="se">\\</span><span class="s1">frac{</span><span class="se">\\</span><span class="s1">pi}</span><span class="si">{3}</span><span class="se">\\</span><span class="s1">right)$&#39;</span>
             <span class="s1">&#39;$ </span><span class="se">\\</span><span class="s1">mathrm</span><span class="si">{CPHASE}</span><span class="s1">_{12, 34}</span><span class="se">\\</span><span class="s1">left(</span><span class="se">\\</span><span class="s1">frac{2</span><span class="se">\\</span><span class="s1">pi}</span><span class="si">{3}</span><span class="se">\\</span><span class="s1">right) $&#39;</span>
             <span class="s1">&#39;$| + </span><span class="se">\\</span><span class="s1">downarrow</span><span class="se">\\</span><span class="s1">downarrow - </span><span class="se">\\</span><span class="s1">rangle = |- </span><span class="se">\\</span><span class="s1">downarrow</span><span class="se">\\</span><span class="s1">downarrow + </span><span class="se">\\</span><span class="s1">rangle$&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_77_0.png" src="../../_images/notebooks_tutorials_CSP_voltage_design_2_Dots_77_0.png" />
</div>
</div>
<p>Inidelity at the end:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="n">cphase_data</span><span class="p">[</span><span class="s1">&#39;fidelity&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
6.167732991002595e-12
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../qudipy.utils.html" class="btn btn-neutral float-left" title="qudipy.utils package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Charge%20Stability.html" class="btn btn-neutral float-right" title="QuDiPy tutorial: using the charge stability module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Coherent Spintronics Group.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>